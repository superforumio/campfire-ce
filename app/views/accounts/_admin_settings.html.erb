<div class="margin-block pad fill-shade border-radius txt-align-center">
  <div class="flex flex-column gap align-center">

    <!-- Authentication Method -->
    <%= form_with model: @account, data: { controller: "form" }, class: "flex flex-column gap align-center" do |form| %>
      <div class="flex flex-column gap align-center" style="--row-gap: 0.5em">
        <strong>Authentication Method</strong>
        <div class="flex flex-column gap-half">
          <label class="flex align-center gap-half">
            <%= form.radio_button :auth_method, "password", data: { action: "change->form#submit" } %>
            <span>Password (email + password)</span>
          </label>
          <label class="flex align-center gap-half">
            <%= form.radio_button :auth_method, "otp", data: { action: "change->form#submit" } %>
            <span>OTP (passwordless, email code)</span>
          </label>
        </div>
      </div>
    <% end %>

    <hr class="separator full-width">

    <!-- Permissions -->
    <div class="flex flex-column gap align-center" style="--row-gap: 0.5em">
      <strong>Permissions</strong>
      <div class="flex flex-column gap">
        <%= form_with model: @account, data: { controller: "form" }, class: "flex align-center gap" do |form| %>
          <label class="switch">
            <%= form.check_box :open_registration, class: "switch__input", data: { action: "change->form#submit" } %>
            <span class="switch__btn"></span>
          </label>
          <span>Allow open registration</span>
        <% end %>

        <%= form_with model: @account, method: :put, data: { controller: "form" }, class: "flex align-center gap" do |form| %>
          <%= form.fields_for :settings, @account.settings do |settings_form| %>
            <%= settings_form.hidden_field :restrict_room_creation_to_administrators,
                value: !Current.account.settings.restrict_room_creation_to_administrators? %>
          <% end %>
          <label class="switch">
            <input type="checkbox"
                  class="switch__input"
                  <%= "checked" if Current.account.settings.restrict_room_creation_to_administrators? %>
                  data-action="change->form#submit">
            <span class="switch__btn"></span>
          </label>
          <span>Only admins can create rooms</span>
        <% end %>

        <%= form_with model: @account, method: :put, data: { controller: "form" }, class: "flex align-center gap" do |form| %>
          <%= form.fields_for :settings, @account.settings do |settings_form| %>
            <%= settings_form.hidden_field :restrict_direct_messages_to_administrators,
                value: !Current.account.settings.restrict_direct_messages_to_administrators? %>
          <% end %>
          <label class="switch">
            <input type="checkbox"
                  class="switch__input"
                  <%= "checked" if Current.account.settings.restrict_direct_messages_to_administrators? %>
                  data-action="change->form#submit">
            <span class="switch__btn"></span>
          </label>
          <span>Only admins can start DMs</span>
        <% end %>
      </div>
    </div>
  </div>
</div>
